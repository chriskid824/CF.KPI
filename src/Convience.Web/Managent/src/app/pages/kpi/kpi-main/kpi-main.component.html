<nz-card>
  <div style="width: 100%; height: 50px">
    <nz-select
      placeholder="公司"
      [(ngModel)]="selectedCompany"
      (change)="onCompanyChange($event.target.value)"
      (ngModelChange)="onCompanyChange($event)"
      style="width: 150px"
    >
      <!-- [(selected)]="selectedCompany" -->
      <nz-option
        *ngFor="let company of companys"
        nzValue="{{ company.paramId }}"
        nzLabel="{{ company.paramValue }}"
      ></nz-option>
    </nz-select>
    <nz-select
      placeholder="部門"
      [(ngModel)]="selectedDepartment"
      (change)="onDepartmentChange($event.target.value)"
      (ngModelChange)="onDepartmentChange($event)"
      style="margin-left: 10px; width: 150px"
    >
      <!-- [(selected)]="selectedDepartment" -->
      <nz-option
        *ngFor="let department of departments"
        nzValue="{{ department.paramId }}"
        nzLabel="{{ department.paramValue }}"
      ></nz-option>
    </nz-select>
    <button
      nz-button
      nzType="primary"
      style="margin-left: 10px; margin-bottom: 5px; width: 100px"
      (click)="search()"
    >
      搜尋
    </button>
    <button
      *ngIf="show"
      nz-button
      nzType="primary"
      nzSize="medium"
      style="width: 150px; float: right"
      (click)="generate()"
    >
      生成年度Kpi資料
    </button>
  </div>
  <!-- <ag-grid-angular  class="ag-theme-alpine" style="width: 1000px; height: 400px;" [columnDefs]="columnDefs" [rowData]="[]">
    </ag-grid-angular> -->
  <ag-grid-angular
    #agGrid
    style="width: 100%; height: 650px"
    id="myGrid"
    class="ag-theme-alpine"
    [columnDefs]="columnDefs"
    [defaultColDef]="defaultColDef"
    [rowData]="rowData"
    (gridReady)="onGridReady($event)"
    [autoGroupColumnDef]="autoGroupColumnDef"
    [suppressDragLeaveHidesColumns]="true"
    [suppressMakeColumnVisibleAfterUnGroup]="true"
    [rowGroupPanelShow]="rowGroupPanelShow"
    [enableCharts]="true"
    [enableRangeSelection]="true"
    [createChartContainer]="createChartContainer"
    [suppressRowTransform]="suppressRowTransform"
    [components]="components"
    [masterDetail]="false"
    [detailCellRendererParams]="detailCellRendererParams"
    (cellDoubleClicked)="open($event)"
    [undoRedoCellEditing]="true"
    [undoRedoCellEditingLimit]="5"
    (cellValueChanged)="onCellValueChanged($event)"
  ></ag-grid-angular>
  <div id="myChart" class="ag-theme-alpine my-chart"></div>
</nz-card>
